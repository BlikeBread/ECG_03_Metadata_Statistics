# ECG Metadata Analysis and Statistics Pipeline (Script 03/03)

This repository contains an R script for metadata integration, statistical analysis, and visualization of ECG feature data.

This script represents the third and final step (03/03) of a modular ECG analysis pipeline.

It takes summary outputs generated by upstream scripts and combines them with externally defined metadata to perform group-wise statistics and generate publication-ready plots.

---

## What the pipeline does

Starting from ECG summary tables and an external metadata file, the script:

1. Loads ECG summary data generated by upstream pipeline steps
2. Loads an externally prepared metadata file
3. Merges ECG summaries with metadata using mouse_id
4. Allows interactive selection of groups to include in analysis and plots
5. Automatically detects the number of groups and applies:
      - t-tests (two groups)
      - one-way ANOVA + Tukey HSD (more than two groups)
6. Computes per-group means, standard deviations, and sample sizes
7. Generates per-metric bar plots with individual data points
8. Exports all results to a structured, analysis-ready folder hierarchy

All file paths and analysis options are selected interactively via GUI dialogs.

---

## Required inputs

1. ECG summary file

Excel file generated by upstream scripts containing: 
    - mouse_id
    - Numeric ECG feature columns

**e.g. Summary_First50_Final_2min.xlsx**

2. Metadata file

The metadata Excel file containing:
    - mouse_id
    - Group (e.g. Control / Treated / WT / HET)

No additional formatting is required.

---

## Statistical outputs

1. stats_per_metric.csv
    - t-test results (2 groups)
    - ANOVA results (>2 groups)

2. stats_tukeyHSD_all_metrics.csv
    - Pairwise post-hoc comparisons (only if >2 groups)

---

## Typical use cases

- ECG drug-response studies
- Genotype-based ECG comparisons
- Multi-group experimental designs
- Rapid generation of summary figures
- Reproducible statistical analysis in collaborative projects

---

## Position in the ECG analysis pipeline

This script is Script 03 of a 3-step ECG analysis workflow:

1. Script 01 – Injection-aligned ECG preprocessing and window generation
2. Script 02 – QRS-based beat selection and First-N averaging
3. Script 03 (this repository) – Metadata integration, statistics, and visualization

Each script is modular and can be reused independently.

---

## Methods description

ECG feature summaries were merged with externally defined metadata and analyzed using a custom R pipeline. Group-wise statistical comparisons were performed using either t-tests or one-way ANOVA depending on the number of experimental groups, followed by Tukey post-hoc testing when appropriate. Data are presented as mean ± SD with individual data points overlaid.

---

## Authorship

This script was developed by **Michele Buono** and can be used and adapted freely for research purposes, provided appropriate citation via Zenodo.

The workflow, structure, and usability of the pipeline were iteratively refined with assistance from **OpenAi - ChatGPT 5.2**, which was used as a tool to improve code organization, documentation, and user interaction.
